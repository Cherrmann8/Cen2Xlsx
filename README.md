# Cen2Xlsx

Author: Charles W. Herrmann
Date: 12/2/2020

# Quickstart

Clone the repository:

```bash
$ git clone https://github.com/Cherrmann8/Cen2Xlsx.git
```

Install the dependencies (requires [pip3](https://pypi.org/project/pip/)):

```bash
$ make install
```

# Overview

Cen2Xlsx is a cross-platform data collection tool for generating community needs assesment reports using data from the United States Census Bureau. Developed with Python 3.7 and Kivy 1.11.

# Usage

The application will be built into a executables for Windows and macOS systems using Pyinstaller. These will eventually be available in the dist directory.

## Source Code Flags

Run the model without the GUI:

```bash
$ python3 src/model.py
```

### `-h` or `--help`

Print usage information.

### `-v` or `--verbose`

Logs additional output to a file in `/logs`.

### `-i` or `--input`

The input directory containing the cached json files. Run using:

```bash
$ python3 src/model.py -i INPUTDIR
# or
$ python3 src/model.py --input INPUTDIR
```

### `-o` or `--output`

The output directory containing the generated reports. Run using:

```bash
$ python3 src/model.py -o OUTPUTDIR
# or
$ python3 src/model.py --output OUTPUTDIR
```

# Design Discussion

## Tools Implementation

Our scanner parses characters in a 'chunk', with a start an and end counter. We iterate through the chunk to match our tokens in the following order: Symbols, Operators, Keywords, Identifiers and Numbers.

We are not optimizing for speed, which is why we opted not to use regular expressions. This gives us more logical control over what tokens we recognize, and it is easier to handle edge cases like multi-line comments.

## Model Implementation

Our parser uses action and goto tables generated from the rules in `grammars/main_grammar.txt`. Because generating the tables takes so long, after the first generation they are saved in JSON format in the `tables/` directory for future compiler executions. The parser outputs a parse tree consisting of instances of custom node classes defined in `grammar.py`. The parse tree nodes are highly abstracted and do not include unimportant tokens like brackets or parentheses.

After the initial creating of the parse tree, it is "flattened" by un-nesting recursive grammar nodes. This makes it easier to generate the symbol table and removes useless duplicate nodes from the tree.

## View Implementation

Our symbol table uses the parse tree to create a new scope for each function declaration. We save each variable declaration inside the appropriate scope, including a global scope. While generating the symbol table we also check for duplicate variable, function declaration and undefined identifiers.

The symbol table also keeps track of goto labels and checks for invalid code that calls goto labels that are never declared. This is done differently to undefined identifier and function checking, as goto labels can be declared anywhere in the program.

## Building the Project

The intermediate representation is generated by visiting each node of the parse tree in depth first order and calling an IR method on each node. These IR methods are defined differently for each node in `grammar.py`. The IR methods currently return strings, and are saved in a simple list.

We use three-address code and intermediate variables to assist with our IR generation. The intermediate variables are uniquely generated so that we can avoid unclear assignments.

Our compiler can skip all of the above steps and start from an already generated IR file by using the `-i` or `--input` flags. You can dump the intermediate representation of a program to a file using the `-o` or `--output` flags.

## Design Benefits

## Limitations

## Required Features

| Tools Features      | Scanner | Parser | IR  | ASM |
|------------------------|---------|--------|-----|-----|
| Identifiers            | ✔       | ✔      | ✔   | ✔   |

| Model Features        | Scanner | Parser | IR  | ASM |
|--------------------------|---------|--------|-----|-----|
| Floats                   | ✔       | ✔      | ✔   |     |

| View Features         | Scanner | Parser | IR  | ASM |
|------------------------|---------|--------|-----|-----|
| Pointers               |         |        |     |     |

## Code Style

Formatted using [Black](https://github.com/ambv/black). Linted using [PyLint](https://www.pylint.org/).
