<script>
	const { PythonShell } = require('python-shell')
	const { ipcRenderer } = require('electron')
	const path = require('path')

	ipcRenderer.on('START_PROCESSING', (event, args) => {
		const { reportArea, selectedIndicators, options } = args

		scriptPath = ''
		if (process.env.IS_DEV === "1") {
			scriptPath = '../src/scripts/pyInterface.py'
		} else {
			scriptPath = '../../extraResources/scripts/pyInterface.py'
		}
		let pyshell = new PythonShell(path.join(__dirname, scriptPath), {
			mode: 'text',
			pythonPath: 'python3',
			args: [JSON.stringify(reportArea), JSON.stringify(selectedIndicators), JSON.stringify(options)],
		})

		pyshell.on('message', function(results) {
			ipcRenderer.send('MESSAGE_FROM_BACKGROUND', results)
		})

		pyshell.on('error', function(results) {
			ipcRenderer.send('MESSAGE_FROM_BACKGROUND', results)
		})
	})

	ipcRenderer.send('BACKGROUND_READY')
</script>