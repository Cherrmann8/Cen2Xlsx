<script>
	const { PythonShell } = require('python-shell')
	const { ipcRenderer } = require('electron')
	const path = require('path')

	ipcRenderer.on('START_PROCESSING', (event, args) => {
		const { reportArea, selectedIndicators, options } = args

		console.log(__dirname)
		console.log(path.join(__dirname, '../../extraResources', 'data/'))
		options["dataDir"] = path.join(__dirname, '../../extraResources', 'data/')

		let pyshell = new PythonShell(path.join(__dirname, '../../extraResources', 'scripts/pyInterface.py'), {
			mode: 'text',
			pythonPath: 'python3',
			args: [JSON.stringify(reportArea), JSON.stringify(selectedIndicators), JSON.stringify(options)],
		})

		pyshell.on('message', function(results) {
			ipcRenderer.send('MESSAGE_FROM_BACKGROUND', results)
		})

		pyshell.on('error', function(results) {
			ipcRenderer.send('MESSAGE_FROM_BACKGROUND', results)
		})
	})

	ipcRenderer.send('BACKGROUND_READY')
</script>